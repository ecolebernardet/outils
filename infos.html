<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Observations CE2-CM2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        :root { --primary: #ff5a98; --bg-dark: #000000; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-dark); margin: 0; padding: 8px; box-sizing: border-box; }
        .columns-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; max-width: 42rem; margin: 0 auto; }
        
        .student-list { list-style: none; padding: 0; margin: 0; background: transparent; }
        
        .student-item { 
            background: #eeeeee; 
            padding: 9px 10px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            cursor: pointer; 
            border-radius: 5rem; 
            margin-bottom: 4px; 
        }
        .student-item:active { transform: scale(0.98); }

        .student-name { font-weight: 600; color: #111827; font-size: 0.7rem; line-height: 1.2; }
        
        .has-comment { 
            background: #ffffff; 
            border: 1px solid var(--primary);
        }
        
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); align-items: center; justify-content: center; z-index: 1000; }
        .modal-content { background: white; padding: 20px; border-radius: 15px; width: 90%; max-width: 350px; }
        textarea { width: 100%; margin: 15px 0; padding: 12px; border-radius: 10px; border: 1px solid #ddd; font-size: 0.9rem; resize: none; background: #f9f9f9; }
        .btns { display: flex; gap: 10px; }
        .modal-btn { flex: 1; padding: 14px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .btn-save { background: var(--primary); color: white; }
        .btn-cancel { background: #eee; color: #555; }

        .nav-btn {
            width: 70%;
            margin: 0 auto;
            display: block;
        }
    </style>
</head>
<body>

    <div class="pt-0 columns-container">
        <div class="column">
            <h2 class="text-rose-400 text-[10px] font-bold uppercase tracking-widest text-center mb-2">CE2</h2>
            <ul class="student-list" id="listLeft"></ul>
        </div>
        <div class="column flex flex-col gap-6">
            <div>
                <h2 class="text-sky-400 text-[10px] font-bold uppercase tracking-widest text-center mb-2">CM2</h2>
                <ul class="student-list" id="listRight"></ul>
            </div>
            
            <div class="px-2 flex flex-col gap-5">
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="openExportModal()" class="nav-btn bg-gray-600 text-white border border-gray-600 font-semibold py-4 rounded-3xl text-[9px] uppercase shadow-md">
                        ðŸ‘† Export
                    </button>
                    <button onclick="openImportModal()" class="nav-btn bg-gray-600 text-white border border-gray-600 font-semibold py-4 rounded-3xl text-[9px] uppercase shadow-md">
                        ðŸ‘‡ Import
                    </button>
                </div>
                <button onclick="window.location.href='index.html'" class="nav-btn bg-[#71bd7b] text-green-950 font-bold py-4 rounded-3xl text-[11px] tracking-widest shadow-md active:scale-95 transition-transform">
                    Accueil
                </button>
            </div>
        </div>
    </div>

    <div id="modal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="modalTitle" style="margin:0; font-size: 1rem; font-weight: 700;">Ã‰lÃ¨ve</h2>
            <textarea id="commentInput" rows="10" placeholder="Ã‰crire une observation..."></textarea>
            <div class="btns">
                <button class="modal-btn btn-cancel" onclick="closeModal('modal')">Annuler</button>
                <button class="modal-btn btn-save" onclick="saveData()">Valider</button>
            </div>
        </div>
    </div>

    <div id="ioModal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="ioTitle" style="margin:0; font-size: 1rem; font-weight: 700;">Action</h2>
            <p class="text-[10px] text-gray-500 mt-2" id="ioDesc"></p>
            <textarea id="ioTextarea" rows="8"></textarea>
            <div class="btns">
                <button class="modal-btn btn-cancel" onclick="closeModal('ioModal')">Fermer</button>
                <button id="ioActionBtn" class="modal-btn btn-save">Action</button>
            </div>
        </div>
    </div>

    <script>
        // --- DONNÃ‰ES INTÃ‰GRÃ‰ES ---
        const rawData =
`Aliya NYCOLLIN-YAHIAOUI,f,ce2
Ariane PEGUET,f,ce2
Eden BRUNO,g,ce2
Elowan BRULÃ‰,g,ce2
Galise ROCHAS,f,ce2
Jean PAGANO,g,ce2
MaÃ«lys HUGOT,f,ce2
Matteo VERNAY,g,ce2
Milan HOSGUL,g,ce2
Noa CONNAC,f,ce2
Sirine ZERAÃBI,f,ce2
Soline LE COADIC,f,ce2
TimÃ©o SIMEONE,g,ce2
Victor BESSON,g,ce2
ZÃ©lie THILLIEZ,f,ce2
CÃ©lina IKHLEF,f,cm2
FÃ©lix DUBOIS,g,cm2
Lila BÃ‚ABÃ‚A,f,cm2
Madeline BLANC,f,cm2
Marouane BENALI,g,cm2
Maxime ALONSO,g,cm2
Mayline ALVAREZ,f,cm2
Nino ROUX,g,cm2
Nolan BOUTARIC,g,cm2
RoumaÃ¯ssa BASSI,f,cm2`;

        let savedComments = JSON.parse(localStorage.getItem('studentObservations')) || {};
        let currentName = "";

        function formatNameDisplay(fullName) {
            const parts = fullName.split(' ');
            if (parts.length === 0) return "";
            const firstName = parts[0].charAt(0).toUpperCase() + parts[0].slice(1).toLowerCase();
            const lastName = parts.slice(1).join(' ').toUpperCase();
            return `${firstName} ${lastName}`;
        }

        function renderList() {
            const listL = document.getElementById('listLeft');
            const listR = document.getElementById('listRight');
            listL.innerHTML = ''; 
            listR.innerHTML = '';
            
            const lines = rawData.split('\n');

            lines.forEach(line => {
                if (line.trim() === "") return;
                
                const [nom, sexe, classe] = line.split(',');
                const studentEl = createStudentElement(nom.trim());

                if (classe && classe.trim().toLowerCase() === 'ce2') {
                    listL.appendChild(studentEl);
                } else {
                    listR.appendChild(studentEl);
                }
            });
        }

        function createStudentElement(nom) {
            const comment = savedComments[nom] || "";
            const li = document.createElement('li');
            li.className = 'student-item' + (comment.trim() ? ' has-comment' : '');
            li.innerHTML = `
                <span class="student-name">${formatNameDisplay(nom)}</span>
                <span style="font-size: 0.8rem;">${comment.trim() ? 'ðŸ”Ž' : 'âž”'}</span>
            `;
            li.onclick = () => openModal(nom);
            return li;
        }

        function openModal(nom) {
            currentName = nom;
            document.getElementById('modalTitle').innerText = formatNameDisplay(nom);
            document.getElementById('commentInput').value = savedComments[nom] || "";
            document.getElementById('modal').style.display = 'flex';
        }

        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function saveData() {
            const val = document.getElementById('commentInput').value;
            if(val.trim() === "") delete savedComments[currentName];
            else savedComments[currentName] = val;
            localStorage.setItem('studentObservations', JSON.stringify(savedComments));
            closeModal('modal'); 
            renderList();
        }

        function openExportModal() {
            const dataStr = JSON.stringify(savedComments);
            document.getElementById('ioTitle').innerText = "Exporter";
            document.getElementById('ioDesc').innerText = "Copiez ce code pour sauvegarder vos notes :";
            document.getElementById('ioTextarea').value = dataStr;
            const btn = document.getElementById('ioActionBtn');
            btn.innerText = "Copier";
            btn.onclick = () => {
                document.getElementById('ioTextarea').select();
                document.execCommand('copy');
                alert("CopiÃ© !");
            };
            document.getElementById('ioModal').style.display = 'flex';
        }

        function openImportModal() {
            document.getElementById('ioTitle').innerText = "Importer";
            document.getElementById('ioDesc').innerText = "Collez votre code de sauvegarde ici :";
            document.getElementById('ioTextarea').value = "";
            const btn = document.getElementById('ioActionBtn');
            btn.innerText = "Valider";
            btn.onclick = () => {
                try {
                    const content = document.getElementById('ioTextarea').value;
                    const data = JSON.parse(content);
                    if(confirm("Ã‰craser les donnÃ©es actuelles ?")) {
                        savedComments = data;
                        localStorage.setItem('studentObservations', JSON.stringify(savedComments));
                        renderList();
                        closeModal('ioModal');
                    }
                } catch(e) { alert("Code invalide."); }
            };
            document.getElementById('ioModal').style.display = 'flex';
        }

        // Initialisation au chargement
        renderList();
    </script>
</body>
</html>